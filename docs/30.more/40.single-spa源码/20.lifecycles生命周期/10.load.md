---
title: load
date: 2022-04-15 13:41:48
permalink: /single-spa/lifecycle/load/
categories:
  - more
  - single-spa
  - lifecycles生命周期
tags:
  - 
---

<TimeToRead />

## app 是什么？

因为上一张中是从宏观上管理微应用，我们只需要知道微应用是一个 object 接口。在这一章中，因为我们要详细探讨微应用的生命周期，这必然要涉及到对微应用中某些属性的操作，因此在探讨 `toLoadPromise` 之前，先来看下 app 是什么？因为 s-spa 不是 typescript 编写的，我们在文档和代码中还原 app 的原状。以内部命名为准。

| 参数 | 描述 |
| -------- | ----------- |
| **name** | App name that single-spa will register and reference this application with, and will be labelled with in dev tools. |
| **loadApp** | Application object or a function that returns the resolved application (Promise or not) |
| **activeWhen** | Can be a path prefix which will match every URL starting with this path, an activity function (as described in the simple arguments) or an array containing both of them.  |
| **customProps** | Will be passed to the application during each lifecycle method. |
| loadErrorTime | 微应用 load 错误的时间点 |
| status | 微应用的状态 |
| parcels | |
| devtools | devtools 的配置 |

::: tip
加粗的参数未用户会配置的参数，其余为内部使用参数。
:::

## toLoadPromise

这个函数的结构很复杂，先来探讨下其结构

```js
function toLoadPromise(app) {
  // P0
  return Promise.resolve().then(() => {
    // ......
    // P1
    return (app.loadPromise = Promise.resolve().then(() => {
      // ......
      // P2
      return app;
    })).catch(err => {
      // ......
      // P3
      return app;
    } )
  })
}
```



参考：
[Applications API | single-spa | registerApplication](https://single-spa.js.org/docs/api#registerapplication)